<form *ngIf="miFormulario != null" [formGroup]="miFormulario" (ngSubmit)="cambiarPassword()" class="password-form">
    <mat-card class="password-card">
      <mat-card-header class="password-header">
        <div class="title-container">
          <mat-icon class="lock-icon">lock_reset</mat-icon>
          <mat-card-title class="password-title">Cambiar Contraseña</mat-card-title>
        </div>
      </mat-card-header>
      
      <mat-card-content class="password-content">
        <div class="input-container">
          <mat-form-field appearance="outline" class="password-field">
            <mat-label>Contraseña Actual</mat-label>
            <input 
              matInput 
              [type]="mostrarPassword ? 'text' : 'password'"
              formControlName="password"
              autocomplete="current-password">
            <button 
              mat-icon-button 
              matSuffix
              (click)="togglePasswordVisibility()"
              type="button"
              class="visibility-btn">
              <mat-icon>{{mostrarPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
            </button>
            <mat-error *ngIf="miFormulario.get('password')?.errors?.['required']">La contraseña actual es requerida</mat-error>
            <mat-error *ngIf="miFormulario.get('password')?.errors?.['minlength']">Mínimo 6 caracteres</mat-error>
          </mat-form-field>
        </div>
        
        <div class="input-container">
          <mat-form-field appearance="outline" class="password-field">
            <mat-label>Nueva Contraseña</mat-label>
            <input 
              matInput 
              [type]="mostrarNuevaPassword ? 'text' : 'password'"
              formControlName="newPassword"
              autocomplete="new-password">
            <button 
              mat-icon-button 
              matSuffix
              (click)="mostrarNuevaPassword = !mostrarNuevaPassword"
              type="button"
              class="visibility-btn">
              <mat-icon>{{mostrarNuevaPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
            </button>
            <mat-error *ngIf="miFormulario.get('newPassword')?.errors?.['required']">La nueva contraseña es requerida</mat-error>
            <mat-error *ngIf="miFormulario.get('newPassword')?.errors?.['minlength']">Mínimo 6 caracteres</mat-error>
          </mat-form-field>
        </div>
        
        <div class="input-container">
          <mat-form-field appearance="outline" class="password-field">
            <mat-label>Confirmar Nueva Contraseña</mat-label>
            <input 
              matInput 
              [type]="mostrarConfirmacionPassword ? 'text' : 'password'"
              formControlName="newPasswordConfirm"
              autocomplete="new-password">
            <button 
              mat-icon-button 
              matSuffix
              (click)="mostrarConfirmacionPassword = !mostrarConfirmacionPassword"
              type="button"
              class="visibility-btn">
              <mat-icon>{{mostrarConfirmacionPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
            </button>
            <mat-error *ngIf="miFormulario.get('newPasswordConfirm')?.errors?.['required']">La confirmación es requerida</mat-error>
            <mat-error *ngIf="miFormulario.get('newPasswordConfirm')?.errors?.['noIguales']">Las contraseñas no coinciden</mat-error>
          </mat-form-field>
        </div>
      </mat-card-content>
      
      <mat-card-actions class="password-actions">
        <button 
          mat-raised-button
          color="primary"
          type="submit"
          class="submit-btn"
          [disabled]="miFormulario.invalid">
          <mat-icon class="icon-btn">key</mat-icon>
          Actualizar Contraseña
        </button>
      </mat-card-actions>
    </mat-card>
  </form>