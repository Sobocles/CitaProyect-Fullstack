<div class="citas-container">
  <!-- Cabecera con estadísticas y búsqueda -->
  <div class="citas-header">
    <div class="stats-card">
      <div class="stats-icon">
        <i class="fas fa-calendar-check"></i>
      </div>
      <div class="stats-info">
        <h4 class="stats-title">Citas Médicas</h4>
        <div class="stats-count">
          Total: <span class="badge-count">{{totalCitas}}</span>
        </div>
      </div>
    </div>
    
    <div class="search-container">
      <div class="search-input-wrapper">
        <i class="fas fa-search search-icon"></i>
        <input 
          type="text"
          class="search-input"
          placeholder="Buscar por paciente, motivo o fecha..."
          #txtTermino
          (keyup)="buscar(txtTermino.value)">
        <button 
          *ngIf="txtTermino.value.length > 0" 
          class="clear-search" 
          (click)="txtTermino.value=''; buscar('')">
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>
  </div>
  
  <!-- Tabla de citas -->
  <div class="citas-table-container">
    <div class="table-responsive">
      <table class="citas-table">
        <thead>
          <tr>
            <th class="th-id">
              <div class="th-content">
                <i class="fas fa-hashtag th-icon"></i>ID
              </div>
            </th>
            <th>
              <div class="th-content">
                <i class="fas fa-comment-medical th-icon"></i>Motivo
              </div>
            </th>
            <th>
              <div class="th-content">
                <i class="fas fa-calendar-day th-icon"></i>Fecha
              </div>
            </th>
            <th>
              <div class="th-content">
                <i class="fas fa-clock th-icon"></i>Horario
              </div>
            </th>
            <th>
              <div class="th-content">
                <i class="fas fa-user-injured th-icon"></i>Paciente
              </div>
            </th>
            <th>
              <div class="th-content">
                <i class="fas fa-tasks th-icon"></i>Estado
              </div>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let cita of citasMedicas" class="cita-row">
            <td class="cita-id">{{ cita.idCita }}</td>
            <td class="cita-motivo">
              <div class="td-content">
                <div class="motivo-text">{{ cita.motivo }}</div>
              </div>
            </td>
            <td class="cita-fecha">
              <div class="fecha-badge">
                <i class="far fa-calendar-alt fecha-icon"></i>
                {{ cita.fecha | date: 'd MMM, yyyy' }}
              </div>
            </td>
            <td class="cita-horario">
              <div class="horario-container">
                <span class="time-badge">
                  <i class="far fa-clock"></i> {{ cita.hora_inicio }}
                </span>
                <span class="time-separator">a</span>
                <span class="time-badge">
                  <i class="far fa-clock"></i> {{ cita.hora_fin }}
                </span>
              </div>
            </td>
            <td class="cita-paciente">
              <div class="paciente-info">
                <div class="paciente-avatar">
                  {{ cita.paciente.nombre.charAt(0) }}{{ cita.paciente.apellidos.charAt(0) }}
                </div>
                <div class="paciente-nombre">
                  <span class="nombre">{{ cita.paciente.nombre }}</span>
                  <span class="apellido">{{ cita.paciente.apellidos }}</span>
                </div>
              </div>
            </td>
            <td class="cita-estado">
              <div class="estado-container">
                <select 
                  class="estado-select" 
                  [ngClass]="{
                    'en-curso': cita.estado === 'en_curso',
                    'terminado': cita.estado === 'terminado',
                    'pagado': cita.estado === 'pagado'
                  }"
                  [(ngModel)]="cita.estado" 
                  (change)="cambioEstado(cita)">
                  <option value="en_curso">En Curso</option>
                  <option value="terminado">Terminado</option>              
                  <option value="pagado">Pagado</option>
                </select>
                <span class="select-arrow"></span>
              </div>
            </td>
          </tr>
          
          <!-- Estado vacío -->
          <tr *ngIf="citasMedicas.length === 0" class="empty-row">
            <td colspan="6">
              <div class="empty-state">
                <i class="fas fa-calendar-times empty-icon"></i>
                <h3 class="empty-title">No hay citas disponibles</h3>
                <p class="empty-message">
                  {{ txtTermino.value.length > 0 ? 'No se encontraron resultados para tu búsqueda.' : 'Actualmente no tienes citas médicas programadas.' }}
                </p>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <!-- Paginador -->
    <div *ngIf="txtTermino.value.length === 0" class="paginador-container">
      <app-paginator
        [totalItems]="totalCitas"
        [(offset)]="desde"
        [pageSize]="5"
        (offsetChange)="cambiarPagina($event)"
        class="custom-paginator">
      </app-paginator>
    </div>
  </div>
</div>